-- The entire evaluation process of
-- ·∾  foldr (+) 0 [1,2,3]
-- so that every call is substituted for foldr's definition
-- where all occurences of a parameter is replaced with its
-- corresponding argument value.
--
-- This recursive call is spread across figures 1-10 on pages 351-353 in the book.


foldr (+) 0 [1,2,3] =
  case [1,2,3] of
    [] -> 0
    (1:[2,3]) ->
--    ((+) 1 ...
      ((+) 1 (foldr (+) 1 [2,3] =
                case [2,3] of
                  [] -> 0
                  (2:[3]) ->
--    ((+) 1 ((+) 2 ...
                    (+) 2 (foldr (+) 2 [3] =
                             case [3] of
                               [] -> 0
                               (3:[]) ->
--    ((+) 1 ((+) 2 ((+) 3 ...
                                    (+) 3 (foldr (+) 0 [1,2,3] =
                                             case [1,2,3] of
                                               [] -> 0
                                               (x:xs) ->
                                                  f x (foldr f z xs)))))
--    ((+) 1 ((+) 2 ((+) 3 0)))


-- With the extraneous parts of each definition removed.
foldr (+) 0 [1,2,3]  =  (+) 1 ((+) 2 ((+) 3  0))


-- Rearranged to use infix notation.
foldr (+) 0 [1,2,3]  =  1 + (2 + (3 + 0))
